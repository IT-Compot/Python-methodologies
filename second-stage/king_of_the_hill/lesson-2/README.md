# Царь горы | Урок 2

На втором занятии мы будем (краткое описание урока)

## Скрипт из шаблона

На прошлом занятии мы создали скрипт из шаблона и протестировали игру.\
Теперь самое время разобраться что же в нём написано.\
(здесь должна быть ссылка на другой readme файл, где разжёвано что написано в шаблонных скриптах)\
(всё-таки перемешивать всё не хочется)

### Добавляем врагов в игру

Продолжаем проект "Царь горы".
Теперь, когда персонаж и сцена у нас готовы, можно приступать к созданию врагов.\
Умное перемещение им не нужно, поэтому возьмём более простой узел, чем `CharacterBody3D`, это `RigidBody3D`:

![7](https://github.com/user-attachments/assets/bed0b9c6-971b-48ea-9759-b87ac5eb14fd)

Какие узлы понадобятся `RigidBody3D` для его корректной работы?
Конечно, это `MeshInstance3D` и `CollisionShape3D`:

![image](https://github.com/user-attachments/assets/da6af2cf-6043-407d-8601-00544e26d39d)

Настроим эти узлы по аналогии с персонажем, добавим в `MeshInstance3D` сферический меш `SphereMesh`, а в `CollisionShape3D` добавим `SphereShape3D`:

![8](https://github.com/user-attachments/assets/92f36613-2af6-494b-ac5d-140e8ecc9419)

Переименуем наш `RigidBody3D` в `bot` и скрепим узлы, чтобы их можно было перетаскивать по сцене:

![9](https://github.com/user-attachments/assets/45f68d3b-d881-4bec-bd64-c3c386c46bb2)

Ботов можно скопировать, сделать сразу несколько на сцене. Для этого используем сочетание клавиш `Ctrl + D` когда в узлах сцены у нас выбран именно `bot`:

![10](https://github.com/user-attachments/assets/62aa985b-04c7-401f-86f2-0864155adb58)

Через клавишу `Shift` можно выбрать сразу несколько ботов на сцене. Это нужно, чтобы редактировать свойства всех выбранных узлов одновременно.\
Используем эту фишку для настройки коллизий.\
\
После этого можно расположить все объекты на сцене, игрока по центру, ботов по сторонам.

### Настраиваем слои коллизии для бота

Если мы запустим игру, то увидим, что игрок не может сталкивать бота.\
Это связано с тем, что и бот и игрок находятся в одном слое коллизии.\
Изменим параметр коллизий у всех ботов сразу, переместим их на разные с игроком слои в параметре `Layer` и выберем параметре `Mask` первый и второй слои.\
\
Это означает, что боты будут сталкиваться и с игроком, и между собой, то есть и с первым и вторым слоем коллизии, когда сами они являются вторым слоем (игрок соответственно на первом).

![11](https://github.com/user-attachments/assets/4c5c36ee-116e-4942-8446-44681b666fe5)

Теперь игрок может перемещаться и сталкивать ботов с платформы.

### Определяем падение бота

Пора нам засчитывать сколько ботов мы столкнули с платформы.\
Какой узел умеет определять вхождение в его зону другой коллизии?\
Правильный ответ - `Area3D`, добавим её в сцену, она потребует от нас коллизии, прикрепим ей сразу коллизию:

![12](https://github.com/user-attachments/assets/c1fb1b8d-00f9-4eef-a20a-26250019fd74)

Самая удобная форма коллизии в нашем случае будет `CylinderShape3D`:

![image](https://github.com/user-attachments/assets/07c326b0-0536-467a-b9f1-7d3e9a05da15)

Настроим `CylinderShape3D` чтобы падающие боты в его коллизию попадали:

![image](https://github.com/user-attachments/assets/be2d81ed-13a9-4c83-9dd7-adf1f7e5c421)

Теперь можно написать код для `Area3D`. Прикрепим скрипт в `Node3D` и прикрепим к этому скрипту сигнал:

![13](https://github.com/user-attachments/assets/7d4610c5-5e24-417c-88cd-d53d0a676b34)

Цель игры - успеть столкнуть всех ботов с платформы за отведённое время.\
Если работаем со временем, какой узел можем прикрепить?\
Это `Timer`, добавим его в дерево сцены:

![image](https://github.com/user-attachments/assets/5416c774-01d1-45f2-ae59-57817268fff2)

Настроим его в инспекторе, выберем время, которое будет этот Таймер отсчитывать. `Autostart` можно включить, в таком случаем Таймер начнёт отсчитывать время при запуске игры.

![image](https://github.com/user-attachments/assets/2962e5bb-cde6-4e7e-9064-24f1cd64e14b)

Прикрепим от Таймера соответствующий сигнал:

![14](https://github.com/user-attachments/assets/647c85c6-7b0d-450e-bf2b-b3db2c59eec4)

Далее можно приступать к коду.

### Пишем скрипт

Определим, что бот падает в зону `Area3D`, напишем принт в функции `_on_area_3d_body_entered()`:

![image](https://github.com/user-attachments/assets/3a556018-152e-4ea4-905e-de2f153fd312)












